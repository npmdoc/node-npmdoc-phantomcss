<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/Huddle/PhantomCSS#readme"

    >phantomcss (v1.1.5)</a>
</h1>
<h4>A CasperJS module for automating visual regression testing of Web apps, live style guides and responsive layouts.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.phantomcss">module phantomcss</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.compareAll">
            function <span class="apidocSignatureSpan">phantomcss.</span>compareAll
            <span class="apidocSignatureSpan">( exclude, diffList, include )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.compareExplicit">
            function <span class="apidocSignatureSpan">phantomcss.</span>compareExplicit
            <span class="apidocSignatureSpan">( list )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.compareFiles">
            function <span class="apidocSignatureSpan">phantomcss.</span>compareFiles
            <span class="apidocSignatureSpan">( baseFile, file )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.compareMatched">
            function <span class="apidocSignatureSpan">phantomcss.</span>compareMatched
            <span class="apidocSignatureSpan">( match, exclude )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.compareSession">
            function <span class="apidocSignatureSpan">phantomcss.</span>compareSession
            <span class="apidocSignatureSpan">( list )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.done">
            function <span class="apidocSignatureSpan">phantomcss.</span>done
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.getCreatedDiffFiles">
            function <span class="apidocSignatureSpan">phantomcss.</span>getCreatedDiffFiles
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.getExitStatus">
            function <span class="apidocSignatureSpan">phantomcss.</span>getExitStatus
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.init">
            function <span class="apidocSignatureSpan">phantomcss.</span>init
            <span class="apidocSignatureSpan">( options )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.screenshot">
            function <span class="apidocSignatureSpan">phantomcss.</span>screenshot
            <span class="apidocSignatureSpan">( target, timeToWait, hideSelector, fileName )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.turnOffAnimations">
            function <span class="apidocSignatureSpan">phantomcss.</span>turnOffAnimations
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.update">
            function <span class="apidocSignatureSpan">phantomcss.</span>update
            <span class="apidocSignatureSpan">( options )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.phantomcss.waitForTests">
            function <span class="apidocSignatureSpan">phantomcss.</span>waitForTests
            <span class="apidocSignatureSpan">( tests )</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.phantomcss" id="apidoc.module.phantomcss">module phantomcss</a></h1>


    <h2>
        <a href="#apidoc.element.phantomcss.compareAll" id="apidoc.element.phantomcss.compareAll">
        function <span class="apidocSignatureSpan">phantomcss.</span>compareAll
        <span class="apidocSignatureSpan">( exclude, diffList, include )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function compareAll( exclude, diffList, include ) {
	var tests = [];

	if ( !diffList ) {
		diffList = getDiffs( _results );
		if(exclude || include){
			diffList = diffList.filter(filterOn( str2RegExp(include), str2RegExp(exclude) ));
		}
		//diffList.forEach(function(path){console.log( &#x27;[PhantomCSS] Attempting visual comparison of &#x27; + path );})
	}

	diffList.forEach( function ( file ) {
		var baseFile = _replaceDiffSuffix( file );
		tests.push( compareFiles( baseFile, file ) );
	} );

	waitForTests( tests );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

### Compare the images when and how you want

```javascript
/*
	String is converted into a Regular expression that matches on full image path
*/
phantomcss.<span class="apidocCodeKeywordSpan">compareAll</span>(&#x27;exclude.test&#x27;);

// phantomcss.compareMatched(&#x27;include.test&#x27;, &#x27;exclude.test&#x27;);
// phantomcss.compareMatched( new RegExp(&#x27;include.test&#x27;), new RegExp(&#x27;exclude.test&#x27;));

/*
	Compare image diffs generated in this test run only
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.compareExplicit" id="apidoc.element.phantomcss.compareExplicit">
        function <span class="apidocSignatureSpan">phantomcss.</span>compareExplicit
        <span class="apidocSignatureSpan">( list )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function compareExplicit( list ) {
	// An explicit list of diff images to compare [&#x27;/dialog.diff.png&#x27;, &#x27;/header.diff.png&#x27;]
	compareAll( void 0, list );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	Compare image diffs generated in this test run only
*/
// phantomcss.compareSession();

/*
	Explicitly define what files you want to compare
*/
// phantomcss.<span class="apidocCodeKeywordSpan">compareExplicit</span>([&#x27;/dialog.diff.png&#x27;, &#x27;/header.diff.png&#
x27;]);

/*
	Get a list of image diffs generated in this test run
*/
// phantomcss.getCreatedDiffFiles();

/*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.compareFiles" id="apidoc.element.phantomcss.compareFiles">
        function <span class="apidocSignatureSpan">phantomcss.</span>compareFiles
        <span class="apidocSignatureSpan">( baseFile, file )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function compareFiles( baseFile, file ) {
	var test = {
		filename: baseFile
	};

	if ( !_isFile( baseFile ) ) {
		test.error = true;
	} else {

		casper.thenOpen( &#x27;about:blank&#x27;, function () {}); // reset page (fixes bug where failure screenshots leak between captures)
		casper.thenOpen( &#x27;file:///&#x27; + _resembleContainerPath, function () {

			asyncCompare( baseFile, file, function ( isSame, mismatch ) {

				if ( !isSame ) {

					test.fail = true;

					casper.waitFor(
						function check() {
							return casper.evaluate( function () {
								return window._imagediff_.hasImage;
							} );
						},
						function () {
							var failFile, safeFileName, increment;

							if ( _failures ) {
								// flattened structure for failed diffs so that it is easier to preview
								failFile = _failures + fs.separator + file.split( /\/|\\/g ).pop().replace( _diffImageSuffix + &#x27;.png&#x27;, &#x27;&#x27; ).replace( &#x27;.png
&#x27;, &#x27;&#x27; );
								safeFileName = failFile;
								increment = 0;

								while ( _isFile( safeFileName + _failureImageSuffix + &#x27;.png&#x27; ) ) {
									increment++;
									safeFileName = failFile + &#x27;.&#x27; + increment;
								}

								failFile = safeFileName + _failureImageSuffix + &#x27;.png&#x27;;
								casper.captureSelector( failFile, &#x27;img&#x27; );

								test.failFile = failFile;
							}

							if ( file.indexOf( _diffImageSuffix + &#x27;.png&#x27; ) !== -1 ) {
								casper.captureSelector( file.replace( _diffImageSuffix + &#x27;.png&#x27;, _failureImageSuffix + &#x27;.png&#x27; ), &#x27;img&#x27; );
							} else {
								casper.captureSelector( file.replace( &#x27;.png&#x27;, _failureImageSuffix + &#x27;.png&#x27; ), &#x27;img&#x27; );
							}

							casper.evaluate( function () {
								window._imagediff_.hasImage = false;
							} );

							if ( mismatch ) {
								test.mismatch = mismatch;
								_onFail( test ); // casper.test.fail throws and error, this function call is aborted
								return; // Just to make it clear what is happening
							} else {
								_onTimeout( test );
							}

						},
						function () {},
						_waitTimeout
					);
				} else {
					test.success = true;
					_onPass( test );
				}

			} );
		} );
	}
	return test;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	Get a list of image diffs generated in this test run
*/
// phantomcss.getCreatedDiffFiles();

/*
	Compare any two images, and wait for the results to complete
*/
// phantomcss.<span class="apidocCodeKeywordSpan">compareFiles</span>(baseFile, diffFile);
// phantomcss.waitForTests();

```

### Best Practices

##### Name your screenshots!
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.compareMatched" id="apidoc.element.phantomcss.compareMatched">
        function <span class="apidocSignatureSpan">phantomcss.</span>compareMatched
        <span class="apidocSignatureSpan">( match, exclude )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function compareMatched( match, exclude ) {
	// Search for diff images, but only compare matched filenames
	compareAll( exclude, void 0, match);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

```javascript
/*
	String is converted into a Regular expression that matches on full image path
*/
phantomcss.compareAll(&#x27;exclude.test&#x27;);

// phantomcss.<span class="apidocCodeKeywordSpan">compareMatched</span>(&#x27;include.test&#x27;, &#x27;exclude.test&#x27;);
// phantomcss.compareMatched( new RegExp(&#x27;include.test&#x27;), new RegExp(&#x27;exclude.test&#x27;));

/*
	Compare image diffs generated in this test run only
*/
// phantomcss.compareSession();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.compareSession" id="apidoc.element.phantomcss.compareSession">
        function <span class="apidocSignatureSpan">phantomcss.</span>compareSession
        <span class="apidocSignatureSpan">( list )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function compareSession( list ) {
	// compare the diffs created in this session
	compareAll( void 0, getCreatedDiffFiles() );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// phantomcss.compareMatched(&#x27;include.test&#x27;, &#x27;exclude.test&#x27;);
// phantomcss.compareMatched( new RegExp(&#x27;include.test&#x27;), new RegExp(&#x27;exclude.test&#x27;));

/*
	Compare image diffs generated in this test run only
*/
// phantomcss.<span class="apidocCodeKeywordSpan">compareSession</span>();

/*
	Explicitly define what files you want to compare
*/
// phantomcss.compareExplicit([&#x27;/dialog.diff.png&#x27;, &#x27;/header.diff.png&#x27;]);

/*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.done" id="apidoc.element.phantomcss.done">
        function <span class="apidocSignatureSpan">phantomcss.</span>done
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function done(){
	_count = 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.getCreatedDiffFiles" id="apidoc.element.phantomcss.getCreatedDiffFiles">
        function <span class="apidocSignatureSpan">phantomcss.</span>getCreatedDiffFiles
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getCreatedDiffFiles() {
	var d = diffsCreated;
	diffsCreated = [];
	return d;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	Explicitly define what files you want to compare
*/
// phantomcss.compareExplicit([&#x27;/dialog.diff.png&#x27;, &#x27;/header.diff.png&#x27;]);

/*
	Get a list of image diffs generated in this test run
*/
// phantomcss.<span class="apidocCodeKeywordSpan">getCreatedDiffFiles</span>();

/*
	Compare any two images, and wait for the results to complete
*/
// phantomcss.compareFiles(baseFile, diffFile);
// phantomcss.waitForTests();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.getExitStatus" id="apidoc.element.phantomcss.getExitStatus">
        function <span class="apidocSignatureSpan">phantomcss.</span>getExitStatus
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getExitStatus() {
	return exitStatus;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.init" id="apidoc.element.phantomcss.init">
        function <span class="apidocSignatureSpan">phantomcss.</span>init
        <span class="apidocSignatureSpan">( options )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function init( options ) {
	update( options );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* `casperjs test demo/testsuite.js --engine=slimerjs`

### Options and setup

If you are using SlimerJS, you will need to specify absolute paths (see &#x27;demo&#x27;).

```javascript
phantomcss.<span class="apidocCodeKeywordSpan">init</span>({

/*
captureWaitEnabled defaults to true, setting to false will remove a small wait/delay on each
screenshot capture - useful when you don&#x27;t need to worry about
animations and latency in your visual tests
*/
captureWaitEnabled: true,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.screenshot" id="apidoc.element.phantomcss.screenshot">
        function <span class="apidocSignatureSpan">phantomcss.</span>screenshot
        <span class="apidocSignatureSpan">( target, timeToWait, hideSelector, fileName )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function screenshot( target, timeToWait, hideSelector, fileName ) {
	var name;

	if ( isComponentsConfig( target ) ) {
		for ( name in target ) {
			if ( isComponentsConfig( target[ name ] ) ) {
				waitAndHideToCapture( target[ name ].selector, name, target[ name ].ignore, target[ name ].wait );
			} else {
				waitAndHideToCapture( target[ name ], name );
			}
		}
	} else {
		if ( isNaN( Number( timeToWait ) ) &#x26;&#x26; ( typeof timeToWait === &#x27;string&#x27; ) ) {
			fileName = timeToWait;
			timeToWait = void 0;
		}
		waitAndHideToCapture( target, fileName, hideSelector, timeToWait );
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	start( url ).
	then(function(){
		
		// do something
		casper.click(&#x27;button#open-dialog&#x27;);
		
		// Take a screenshot of the UI component
		phantomcss.<span class="apidocCodeKeywordSpan">screenshot</span>(&#x27;#the-dialog&#x27;, &#x27;a screenshot of my dialog&#x27
;);

	});
```

From the command line/terminal run:

* `casperjs test demo/testsuite.js`
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.turnOffAnimations" id="apidoc.element.phantomcss.turnOffAnimations">
        function <span class="apidocSignatureSpan">phantomcss.</span>turnOffAnimations
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function turnOffAnimations() {
	console.log( &#x27;[PhantomCSS] Turning off animations&#x27; );
	casper.evaluate( function turnOffAnimations() {

		function disableAnimations() {
			var jQuery = window.jQuery;
			if ( jQuery ) {
				jQuery.fx.off = true;
			}

			var css = document.createElement( &#x22;style&#x22; );
			css.type = &#x22;text/css&#x22;;
			css.innerHTML = &#x22;* { -webkit-transition: none !important; transition: none !important; -webkit-animation: none !important; animation
: none !important; }&#x22;;
			document.body.appendChild( css );
		}

		if ( document.readyState !== &#x22;loading&#x22; ) {
			disableAnimations();
		} else {
			window.addEventListener( &#x27;load&#x27;, disableAnimations, false );
		}
	} );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	*/
	rebase: casper.cli.get(&#x22;rebase&#x22;)
});

/*
	Turn off CSS transitions and jQuery animations
*/
phantomcss.<span class="apidocCodeKeywordSpan">turnOffAnimations</span>();
```

### Don&#x27;t like pink?

![A failed visual regression test, yellow areas show where the icon has enlarged and pushed other elements down.](https://raw.github
.com/Huddle/PhantomCSS/master/readme_assets/differentcolour.png &#x22;Failed visual regression test&#x22;)

```javascript
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.update" id="apidoc.element.phantomcss.update">
        function <span class="apidocSignatureSpan">phantomcss.</span>update
        <span class="apidocSignatureSpan">( options )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function update( options ) {

	function stripslash( str ) {
		return ( str || &#x27;&#x27; ).replace( /\/\//g, &#x27;/&#x27; ).replace( /\\/g, &#x27;\\&#x27; );
	}

	options = options || {};

	casper = options.casper || casper;

	_waitTimeout = options.waitTimeout || _waitTimeout;

	_libraryRoot = options.libraryRoot;

	_resemblePath = _resemblePath || getResemblePath( _libraryRoot );

	_resembleContainerPath = _resembleContainerPath || getResembleContainerPath( _libraryRoot );

	_src = stripslash( options.screenshotRoot || _src );
	_results = stripslash( options.comparisonResultRoot || options.screenshotRoot || _results || _src );
	_failures = options.failedComparisonsRoot === false ? false : stripslash( options.failedComparisonsRoot || _failures );

	_fileNameGetter = options.fileNameGetter || _fileNameGetter;

	_prefixCount = options.prefixCount || _prefixCount;
	_isCount = ( options.addIteratorToImage !== false );

	_onPass = options.onPass || _onPass;
	_onFail = options.onFail || _onFail;
	_onTimeout = options.onTimeout || _onTimeout;
	_onNewImage = options.onNewImage || _onNewImage;
	_onComplete = options.onComplete || options.report || _onComplete;

	_hideElements = options.hideElements;

	_mismatchTolerance = options.mismatchTolerance || _mismatchTolerance;

	_rebase = isNotUndefined(options.rebase) ? options.rebase : _rebase;

	_resembleOutputSettings = options.outputSettings || _resembleOutputSettings;

	_resembleOutputSettings.useCrossOrigin=false; // turn off x-origin attr in Resemble to support SlimerJS

	_cleanupComparisonImages = options.cleanupComparisonImages || _cleanupComparisonImages;

	_baselineImageSuffix = options.baselineImageSuffix || _baselineImageSuffix;
	_diffImageSuffix = options.diffImageSuffix || _diffImageSuffix;
	_failureImageSuffix = options.failureImageSuffix || _failureImageSuffix;

	_captureWaitEnabled = isNotUndefined(options.captureWaitEnabled) ? options.captureWaitEnabled : _captureWaitEnabled;

	if ( options.addLabelToFailedImage !== undefined ) {
		_addLabelToFailedImage = options.addLabelToFailedImage;
	}

	if ( _cleanupComparisonImages ) {
		_results += fs.separator + generateRandomString();
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.phantomcss.waitForTests" id="apidoc.element.phantomcss.waitForTests">
        function <span class="apidocSignatureSpan">phantomcss.</span>waitForTests
        <span class="apidocSignatureSpan">( tests )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function waitForTests( tests ) {
	casper.then( function () {
		casper.waitFor( function () {
				return tests.length === tests.reduce( function ( count, test ) {
					if ( test.success || test.fail || test.error ) {
						return count + 1;
					} else {
						return count;
					}
				}, 0 );
			}, function () {
				var fails = 0,
					errors = 0;
				tests.forEach( function ( test ) {
					if ( test.fail ) {
						fails++;
					} else if ( test.error ) {
						errors++;
					}
				} );
				_onComplete( tests, fails, errors );
			}, function () {

			},
			_waitTimeout );
	} );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
// phantomcss.getCreatedDiffFiles();

/*
	Compare any two images, and wait for the results to complete
*/
// phantomcss.compareFiles(baseFile, diffFile);
// phantomcss.<span class="apidocCodeKeywordSpan">waitForTests</span>();

```

### Best Practices

##### Name your screenshots!
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
